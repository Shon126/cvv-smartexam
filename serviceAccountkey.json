import firebase_admin
from firebase_admin import credentials, db
import json

# Load the service account key
with open("serviceAccountKey.json") as f:
    service_key = json.load(f)
    project_id = service_key.get("project_id", "")

# Match the correct database URL based on project_id
database_urls = {
    "cvv-smartexam": "https://cvv-smartexam-default-rtdb.asia-southeast1.firebasedatabase.app",
    "cvv-smartexam-v2": "https://cvv-smartexam-v2-default-rtdb.firebaseio.com",
    # Add more projects here if needed
}

# Get matching database URL or raise error
db_url = database_urls.get(project_id)
if not db_url:
    raise ValueError(f"No database URL found for project_id: {project_id}")

# Initialize Firebase app only once
if not firebase_admin._apps:
    cred = credentials.Certificate("serviceAccountKey.json")
    firebase_admin.initialize_app(cred, {
        'databaseURL': db_url
    })